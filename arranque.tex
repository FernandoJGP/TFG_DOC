%!TEX root =  tfg.tex
\chapter{Arranque}

\begin{abstract}
Durante este capítulo de la memoria se presentará la lista de características que conforman el proyecto, así como el diseño arquitectónico de Unreal Engine, el motor gráfico elegido para llevar a cabo el proyecto.
\end{abstract}

\section{Lista de características}
La lista de características está confeccionada a partir del documento de diseño, incorporado como anexo a este documento (Ver apéndice \ref{sec:gdd}), por tanto, para encontrar una descripción más detallada tendremos que remitirnos a dicho anexo.

\begin{enumerate}
	\item Creación del personaje.
	\item Creación de una cámara "`True first person camera"'.
	\item Creación de una cámara en tercera persona.
	\item Mecánica: Movimiento del personaje.
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Asignación de teclas y botones vinculados la mecánica.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
	\end{itemize}
	\item Mecánica: Rotación del personaje.
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Asignación de teclas y botones vinculados la mecánica.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
	\end{itemize}
	\item Mecánica: Rotación del personaje vinculada a un rate.
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Asignación de teclas y botones vinculados la mecánica.
	\end{itemize}
	\item Mecánica: Sprint.
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Asignación de teclas y botones vinculados la mecánica.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
	\end{itemize}
	\item Mecánica: Salto.
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Asignación de teclas y botones vinculados la mecánica.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
	\end{itemize}
	\item Mecánica: Agachar.
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Asignación de teclas y botones vinculados la mecánica.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
	\end{itemize}
	\item Mecánica: Tiempo bala (o "`Time dilation"').
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Asignación de teclas y botones vinculados la mecánica.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
		\item Gestión de adrenalina relacionada con la mecánica.
	\end{itemize}
	\item Mecánica: Teletransporte (o "`Blink"').
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Asignación de teclas y botones vinculados la mecánica.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
		\item Gestión de adrenalina relacionada con la mecánica.
		\item Implementación del código del indicador de blink disponible.
	\end{itemize}
	\item Control de límites del mapa (en otras palabras, que el usuario no pueda abandonar el mapa y si lo hace, muera).
	\begin{itemize}
		\item Implementación del código de la mecánica.
	\end{itemize}
	\item Control de máxima distancia de caída (en otras palabras, que el usuario al caer en una superficie situada en un foso, muera).
	\begin{itemize}
		\item Implementación del código de la mecánica.
	\end{itemize}
	\item Animación de rotación del personaje al girarse.
	\begin{itemize}
		\item Implementación del código.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
	\end{itemize}
	\item Sistema de gestión de adrenalina.
	\begin{itemize}
		\item Implementación del código.
	\end{itemize}
	\item Base del sistema de escalada (*).
	\begin{itemize}
		\item Implementación del código de la base del sistema de escalada.
	\end{itemize}
	\item Mecánica: Agarrar un saliente (*).
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
	\end{itemize}
		\item Mecánica: Agarrar un saliente pequeño y escalarlo (*).
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
	\end{itemize}
	\item Mecánica: Escalar un saliente al que estemos agarrados (*).
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Asignación de teclas y botones vinculados la mecánica.
	\end{itemize}
	\item Mecánica: Soltar un saliente (*).
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
	\end{itemize}
	\item Mecánica: Movernos por un saliente.
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
	\end{itemize}
	\item Mecánica: Saltar desde saliente lateralmente.
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
	\end{itemize}
	\item Mecánica: Mirar hacia atrás desde saliente.
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
	\end{itemize}
	\item Mecánica: Saltar desde saliente mirando hacia atrás
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
	\end{itemize}
	\item Mecánica: Escalada en pared (*).
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
	\end{itemize}
	\item Mecánica: Giro y salto durante escalada en pared.
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Desarrollo de la animación del personaje relacionada con la mecánica.
	\end{itemize}
	\item Sistema de guardado / carga.
	\begin{itemize}
		\item Implementación en código.
	\end{itemize}
	\item Sistema de muerte.
	\begin{itemize}
		\item Implementación del código de la mecánica.
		\item Recreación de la muerte del personaje cambiando su estado a "`ragdoll"' o "`muñeco de trapo"'.
	\end{itemize}
	\item Creación del HUD del usuario, con los siguientes elementos:
	\begin{itemize}
		\item Punto de referencia.
		\item Indicador de "`blink"'.
		\item Indicador de adrenalina restante.
		\item Brújula, que le permita conocer al jugador el punto al que debe dirigirse para acabar el nivel.
		\item Mensaje de muerte, que aparezca sólo cuando el usuario esté muerto.
		\item Caja de tutorial, que serán usadas para mostrarles mensajes al jugador hasta que pulse el botón "`acción"'.
		\item Recuadro de logro, que aparecerá en pantalla cuando el jugador obtenga uno.
		\item Recuadro de juego guardado, que aparecerá al guardar juego.
	\end{itemize}
	\item Creación de un menú principal:
	\begin{itemize}
			\item Creación del mapa del menú principal.
			\item Opción: Nuevo juego, que nos permita empezar una partida desde cero.
			\item Opción: Cargar juego, que nos permita continuar nuestro progreso.
			\item Opción: Ajustes, que nos permita realizar cambios en la configuración.
			\item Opción: Salir del juego.
		\end{itemize}
	\item Creación de un menú de pausa:
	\begin{itemize}
			\item Opción: Nuevo juego, que nos permita empezar una partida desde cero.
			\item Opción: Cargar juego, que nos permita continuar nuestro progreso.
			\item Opción: Ajustes, que nos permita realizar cambios en la configuración.
			\item Opción: Cerrar el menú.
			\item Opción: Volver al menú principal.
			\item Opción: Salir del juego.
		\end{itemize}
	\item Creación de un menú de ajustes, que nos de las siguientes opciones:
	\begin{itemize}
			\item Opción: Seleccionar idioma (inglés o español).
			\item Opción: Seleccionar relación de aspecto de la resolución.
			\item Opción: Seleccionar resolución.
			\item Opción: Seleccionar entre modo pantalla completa y modo ventana.
			\item Opción: Seleccionar diversos ajustes gráficos.
			\item Opción: Cerrar el menú.
		\end{itemize}
	\item Mecánica de puzle: Botón.
	\begin{itemize}
		\item Implementación del código.
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Mecánica de puzle: Palanca.
	\begin{itemize}
		\item Implementación del código.
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Mecánica de puzle: Placa de presión.
	\begin{itemize}
		\item Implementación del código.
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Mecánica de puzle: Palanca de presión con bordes.
	\begin{itemize}
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Mecánica de puzle: Puerta activable.
	\begin{itemize}
		\item Implementación del código.
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Mecánica de puzle: Puerta auto-activable por poder.
	\begin{itemize}
		\item Implementación del código.
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Mecánica de puzle: Ascensor.
	\begin{itemize}
		\item Implementación del código.
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Mecánica de puzle: Recoger "`pickables"'.
	\begin{itemize}
		\item Implementación del código.
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Mecánica de puzle: Soltar "`pickables"'.
	\begin{itemize}
		\item Implementación del código.
	\end{itemize}
	\item Mecánica de puzle: Orbe dorado.
	\begin{itemize}
		\item Implementación del código.
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Mecánica de puzle: Barrera mágica.
	\begin{itemize}
		\item Implementación del código.
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Mecánica de puzle: Expositor de "`pickables"'.
	\begin{itemize}
		\item Implementación del código.
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Mecánica de puzle: Rampa y cilindro (puzle de físicas).
	\begin{itemize}
		\item Implementación del código / configuración.
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Mecánica de puzle: Display digital.
	\begin{itemize}
		\item Implementación del código.
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Peligros y obstáculos: Láser movible.
	\begin{itemize}
		\item Implementación del código.
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Peligros y obstáculos: Bloque movible.
	\begin{itemize}
		\item Implementación del código.
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Peligros y obstáculos: Bloque movible con pinchos.
	\begin{itemize}
		\item Implementación del código.
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Coleccionables.
	\begin{itemize}
		\item Implementación del código.
		\item Realización / obtención del modelo usado.
	\end{itemize}
	\item Inteligencia artificial: Torretas.
	\begin{itemize}
		\item Creación del árbol de comportamiento.
		\item Creación de las comprobaciones del árbol.
		\item Creación de la tarea de Patrulla.
		\item Creación de la tarea de Ataque.
		\item Creación del proyectil a disparar (y sus cualidades).
	\end{itemize}
	\item Inteligencia artificial: Vigilantes.
	\begin{itemize}
		\item Creación del árbol de comportamiento (*).
		\item Creación de las comprobaciones del árbol (*).
		\item Creación de la tarea de Patrulla (*).
		\item Creación de la tarea de Alerta por sonido.
		\item Creación de la tarea de Seguimiento (*).
		\item Creación de la tarea de Ataque.
	\end{itemize}
	\item Mecánica: Caja de tutorial.
	\begin{itemize}
		\item Implementación del código de la mecánica.
	\end{itemize}
	\item Mecánica: Multi-caja de tutorial.
	\begin{itemize}
		\item Implementación del código de la mecánica.
	\end{itemize}
	\item Mapa: Introduction.
	\begin{itemize}
		\item Realización del HUD usado para el mapa.
		\item Realización de los scripts del mapa.
	\end{itemize}
	\item Mapa: Ending.
	\begin{itemize}
		\item Realización del HUD usado para el mapa.
		\item Realización de los scripts del mapa.
	\end{itemize}
	\item Mapa: Tutorial.
	\begin{itemize}
		\item Realización de la estrucctura básica del mapa.
		\item Decoración: follaje, columnas, escaleras, etc.
		\item Realización de puzles.
		\item Iluminado del mapa.
	\end{itemize}
	\item Mapa: Level1.
	\begin{itemize}
		\item Realización de la estrucctura básica del mapa.
		\item Decoración: follaje, columnas, escaleras, etc.
		\item Realización de puzles.
		\item Iluminado del mapa.
		\item Colocación de enemigos y tareas asociadas (puntos de ruta, nav meshes, ...).
	\end{itemize}
	\item Mapa: Level2.
	\begin{itemize}
		\item Realización de la estrucctura básica del mapa.
		\item Decoración: follaje, columnas, escaleras, etc.
		\item Realización de puzles.
		\item Iluminado del mapa.
		\item Colocación de enemigos y tareas asociadas (puntos de ruta, nav meshes, ...).
	\end{itemize}
	\item Secuencia de inicio del juego.
	\item Fade from black: Secuencia usada al iniciar un nivel.
	\item Fade to white: Secuencia usada al tocar un cristal de teletransportación.
\end{enumerate}

\clearpage

\section{Diseño arquitectónico}
\label{sec:arquitectura}

En el momento que hablamos de diseño arquitectónico en el marco de este proyecto estamos refiriéndonos indirectamente al diseño arquitectónico del \gls{motorgrafico} que estamos utilizando, "`Unreal Engine 4"'.

\subsection{Módulos de juego}

El \gls{motorgrafico} Unreal Engine 4 está compuesto por una colección de módulos y, de la misma forma, cada juego desarrollado en él está compuesto por uno o más módulos, denominados módulos de juego, que en realidad son \textbf{DLLs} \cite{uedoc}.

De esta manera, la arquitectura básica de un juego desarrollado con Unreal Engine 4 es la siguiente:

\begin{figure*}[htb]
	\centering
		\includegraphics[scale=0.8]{figures/ue4-arquitectura.png}
		\caption{Arquitectura Unreal Engine 4 \cite{uedoc}}
\end{figure*}

\clearpage

Como podemos apreciar, podemos estructurar nuestro proyecto en tantos módulos de juego como creamos necesario. Sin embargo, respecto a la creación de múltiples módulos de juego Epic Games nos hace saber:

\textit{Hay diferentes puntos de vista respecto a la separación en DLL. Separar el juego en un montón de archivos DLL puede tener más inconvenientes que beneficios, pero es una decisión que debe ser hecha por cada equipo de desarrollo basada en sus necesidades. Usar múltiples módulos de juego puede conducir en mejores tiempos de enlace e iteración de código más rápida, pero con más módulos será necesario lidiar con exportaciones de DLL e interfaces más a menudo. Esta concesión es la correcta para el motor y el editor, pero es cuestionable para el juego} \cite{uedoc}.

Como podemos apreciar, no hay una ventaja clara en usar varios módulos de juego, por lo que para la estructuración de este proyecto usaremos la opción más simple: usar un único módulo de juego, llamado "`TFG"' que contenga todas las clases de juego:

\begin{figure*}[htb]
	\centering
		\includegraphics[scale=0.8]{figures/proyecto-arquitectura.png}
		\caption{Estructura del proyecto}
\end{figure*}

\clearpage

\subsection{Clases de juego}

Cada módulo de juego contiene indeterminadas clases C++ y estas están compuestas por una clase cabecera ("`.h"') y una clase de archivo fuente ("`.cpp"'). La clase cabecera contiene las declaraciones de la clase y sus miembros, como variables y funciones, mientras que la clase de archivo fuente es donde la funcionalidad de la clase se define implementando las funciones que pertenecen a la clase \cite{uedoc}.

Además, cabe destacar que en Unreal Engine se usa un sistema de prefijos, que se seguirá en la medida de lo posible en el desarrollo de este proyecto. Los prefijos pueden ser:

\begin{table*}[h!]
	\centering
	\begin{coolTable}{lp{13cm}}{2}
{Prefijos de clases de gameplay en Unreal Engine}
	\textbf{Prefijo}&\textbf{Significado}\\
	\textbf{A}&Extiende desde la clase base "`spawneable"'. Son los denominados "`actores"', y pueden ser emplazados directamente en el mundo o escenario del juego.\\
	\textbf{U}&Extiende desde la clase base de todos los objetos de juego. No pueden ser instanciados directamente en el mundo, deben pertenecer a un "`actor"'. Son generalmente objetos como "`componentes"'.\\
	\end{coolTable}
	\caption{Prefijos de clases de juego en Unreal Engine \cite{uedoc}}
\end{table*}